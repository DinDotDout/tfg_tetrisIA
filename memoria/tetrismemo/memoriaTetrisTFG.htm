<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Yu Gothic Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Mincho";
	panose-1:2 2 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"WenQuanYi Micro Hei";}
@font-face
	{font-family:"Lohit Hindi";}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"\@Yu Gothic Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Mincho";}
@font-face
	{font-family:"\@Lohit Hindi";}
@font-face
	{font-family:"\@WenQuanYi Micro Hei";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2F5496;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
p.Titulo, li.Titulo, div.Titulo
	{mso-style-name:Titulo;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;
	color:#2F5496;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Arial",sans-serif;
	color:#2F5496;}
p.Style2, li.Style2, div.Style2
	{mso-style-name:Style2;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2F5496;}
.MsoChpDefault
	{font-size:10.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:127.6pt 70.9pt 99.25pt 96.4pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:127.6pt 70.9pt 99.25pt 96.4pt;}
div.WordSection2
	{page:WordSection2;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body bgcolor=white lang=EN-US link="#0563C1" vlink="#954F72" style='word-wrap:
break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt'>BACHELOR’S THESIS</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=right style='text-align:right'><b><span
style='font-size:18.0pt'>TETRIS NEURAL NET PLAYING IN THE NINTENDO SWITCH</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b><span style='font-size:18.0pt'>Joan
Dot Sastre</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='line-height:200%'><b>Degree in </b><b><span
style='line-height:200%'>informatic engineering</span></b></p>

<p class=MsoNormal style='line-height:200%'><b>Faculty of </b><b><span
style='line-height:200%'>engineering</span></b></p>

<p class=MsoNormal style='line-height:200%'><span style='font-size:10.0pt;
line-height:200%'>&nbsp;</span></p>

<p class=MsoNormal style='line-height:200%'><b><span style='font-size:10.0pt;
line-height:200%'>Academic Year 20</span></b><b><span style='font-size:10.0pt;
line-height:200%'>20-21</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>&nbsp;</i></p>

<i><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span></i>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='line-height:200%'><span style='font-size:11.0pt;
line-height:200%'>Key words: </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span
style='font-size:11.0pt'><a name=tag></a></span><span style='font-size:11.0pt'>word
1, word 2, word 3, …</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i><span style='font-size:8.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i><span style='font-size:8.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i><span style='font-size:10.0pt'>Thesis
Supervisor’s Name Jose María Buades<span style='color:#DDD9C3'>            </span></span></i></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i><span style='font-size:10.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i><span style='font-size:10.0pt'>Tutor’s
Name (if applicable) Jose María Buades<span style='color:#DDD9C3'>                                       </span></span></i></p>

<p class=MsoNormal><i><span style='font-size:10.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal><i><span style='font-size:10.0pt'>&nbsp;</span></i></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=529
 style='margin-left:4.25pt;border-collapse:collapse;border:none'>
 <tr style='height:6.55pt'>
  <td width=416 rowspan=3 style='width:11.0cm;border:none;padding:1.4pt 1.4pt 1.4pt 4.25pt;
  height:6.55pt'>
  <p class=MsoNormal><span style='font-size:10.0pt'>The University is hereby
  authorized to include this project in its institutional repository for its
  open consultation and online dissemination, for academic and research
  purposes only.</span></p>
  </td>
  <td width=57 colspan=2 style='width:42.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:4.25pt 0cm 0cm 4.25pt;height:6.55pt'>
  <p class=MsoNormal><span style='font-size:8.0pt'>   Author</span></p>
  </td>
  <td width=57 colspan=2 style='width:42.5pt;border:none;padding:1.4pt 0cm 1.4pt 4.25pt;
  height:6.55pt'>
  <p class=MsoNormal><span style='font-size:8.0pt'>   Supervisor</span></p>
  </td>
 </tr>
 <tr style='height:6.5pt'>
  <td width=28 style='width:21.3pt;border:none;padding:4.25pt 1.4pt 0cm 4.25pt;
  height:6.5pt'>
  <p class=MsoNormal><span style='font-size:8.0pt'> Yes</span></p>
  </td>
  <td width=28 style='width:21.25pt;border:none;border-right:solid windowtext 1.0pt;
  padding:1.4pt 0cm 1.4pt 2.85pt;height:6.5pt'>
  <p class=MsoNormal><span style='font-size:8.0pt'> No</span></p>
  </td>
  <td width=30 style='width:22.6pt;border:none;padding:1.4pt 0cm 1.4pt 4.25pt;
  height:6.5pt'>
  <p class=MsoNormal><span style='font-size:8.0pt'> Yes</span></p>
  </td>
  <td width=27 style='width:19.9pt;border:none;padding:1.4pt 0cm 1.4pt 2.85pt;
  height:6.5pt'>
  <p class=MsoNormal><span style='font-size:8.0pt'> No</span></p>
  </td>
 </tr>
 <tr style='height:13.55pt'>
  <td width=28 valign=top style='width:21.3pt;border:none;padding:1.4pt 1.4pt 1.4pt 4.25pt;
  height:13.55pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-size:8.0pt;font-family:"Segoe UI Symbol",sans-serif'>&#9746;</span></p>
  </td>
  <td width=28 valign=top style='width:21.25pt;border:none;border-right:solid windowtext 1.0pt;
  padding:1.4pt 0cm 1.4pt 2.85pt;height:13.55pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-size:8.0pt;font-family:"Segoe UI Symbol",sans-serif'>&#9744;</span></p>
  </td>
  <td width=30 valign=top style='width:22.6pt;border:none;padding:1.4pt 0cm 1.4pt 4.25pt;
  height:13.55pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-size:8.0pt;font-family:"Segoe UI Symbol",sans-serif'>&#9744;</span></p>
  </td>
  <td width=27 valign=top style='width:19.9pt;border:none;padding:1.4pt 0cm 1.4pt 2.85pt;
  height:13.55pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='font-size:8.0pt;font-family:"Segoe UI Symbol",sans-serif'>&#9744;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><i><span style='font-size:8.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal><i><span style='font-size:8.0pt'>&nbsp;</span></i></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b><span style='font-size:14.0pt;
color:#0065BD;background:white'>Abstract</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='color:black;
background:white'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='color:black;
background:white'>&nbsp;</span></p>

<p class=MsoNormal><i><span style='font-size:8.0pt'>&nbsp;</span></i></p>

<i><span style='font-size:8.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span></i></div>

<i><span style='font-size:8.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span></i>

<div class=WordSection2>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='color:black;
background:white'>&nbsp;</span></p>

<p class=MsoTocHeading>Contents</p>

<p class=MsoToc1><a
href="#_Toc73975397"><span style='font-family:"Times New Roman",serif'>1.
Introduction</span><span style='font-family:"Times New Roman",serif;color:windowtext;
display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc73975398"><span style='font-family:"Times New Roman",serif'>1.1.
Project summary</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc73975399"><span style='font-family:"Times New Roman",serif'>1.2.
Artificial intelligence in videogames</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'> </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc73975400"><span style='font-family:"Times New Roman",serif'>1.3
Objectives</span><span style='font-family:"Times New Roman",serif;color:windowtext;
display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>2</span></a></p>

<p class=MsoToc1><a href="#_Toc73975401"><span style='font-family:"Times New Roman",serif'>2.
Tetris 99 and system build</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc73975402"><span style='font-family:"Times New Roman",serif'>2.1
Game basics</span><span style='font-family:"Times New Roman",serif;color:windowtext;
display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc73975403"><span style='font-family:"Times New Roman",serif'>2.2
UI and specifics</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'> </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc73975404"><span style='font-family:"Times New Roman",serif'>2.2
SRS (Standard rotation system)</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'> </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>7</span></a></p>

<p class=MsoToc2><a href="#_Toc73975405"><span style='font-family:"Times New Roman",serif'>2.3
System</span><span style='font-family:"Times New Roman",serif;color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>9</span></a></p>

<p class=MsoToc1><a href="#_Toc73975406"><span style='font-family:"Times New Roman",serif'>3.
Switch-PC interface</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>9</span></a></p>

<p class=MsoToc1><a href="#_Toc73975407"><span style='font-family:"Times New Roman",serif'>4.
Information capture</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>10</span></a></p>

<p class=MsoToc1><a href="#_Toc73975408"><span style='font-family:"Times New Roman",serif'>5.
Deep learning module</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>10</span></a></p>

<p class=MsoToc1><a href="#_Toc73975409"><span style='font-family:"Times New Roman",serif'>6.
Decision making</span><span style='font-family:"Times New Roman",serif;
color:windowtext;display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>10</span></a></p>

<p class=MsoToc1><a href="#_Toc73975410"><span style='font-family:"Times New Roman",serif'>7.
Results</span><span style='font-family:"Times New Roman",serif;color:windowtext;
display:none;text-decoration:none'>. </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>10</span></a></p>

<p class=MsoToc1><a href="#_Toc73975411"><span style='font-family:"Times New Roman",serif'>8.
Conclusions</span><span style='font-family:"Times New Roman",serif;color:windowtext;
display:none;text-decoration:none'> </span><span
style='font-family:"Times New Roman",serif;color:windowtext;display:none;
text-decoration:none'>10</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><span
style='color:black;background:white'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975397"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>1. Introduction</p>

<p class=Style1>&nbsp;</p>

<p class=Style1><a name="_Toc73975398">1.1. Project summary</a></p>

<p class=Style1>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The basis of
this project consists in achieving an AI capable of playing the game “Tetris 99”
in the console known as “Switch”, manufactured by the famous game company
Nintendo. The task may seem simple at the beginning, but the sole nature of
having to intercommunicate two devices already shows us that this will not be a
trivial matter. The AI has to be built and trained through a PC, and then be
able to receive and send information to the console reliably.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1><a name="_Toc73975399">1.2. Artificial intelligence in
videogames</a></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:6.0pt;
margin-left:141.6pt;text-align:justify;text-indent:-141.6pt'> </p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Artificial
intelligence has been present in videogames since the very beginning.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Its purpose
has always been to improve the players experience and the methods that have
been used to implement such behaviours are vast, ranging from finite state
machines and increasingly more complex enemy movement patterns tied to the game
difficulty/level, to combining different advanced methods like pathfinding and
decision trees. Other techniques related to machine learning such as reinforcement
learning can also currently be found in some games. All these methods are mostly
used for NPCs (non-playable characters) and the information they perceive from
the environment can be given in two different ways, via sensors, which provide
a limited vision of the game world, or via the game’s own stored information
e.g., the player’s exact location.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>(<a
href="https://en.wikipedia.org/wiki/Artificial_intelligence_in_video_games">https://en.wikipedia.org/wiki/Artificial_intelligence_in_video_games</a>)</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Due to an
increasing interest in artificial intelligence in recent years, people have
started to try and beat their favourite games with it. When taking this
approach, we must first consider how the agent* is going to perceive the game,
having the same two options we talked about before. This time we usually
encounter a major inconvenience, we do not have direct access to the game
information due to us not being the game developers, although thanks to some
APIs (such as OpenAI Gym) we can access the game and thus base our agent’s
information on it. Unfortunately, those APIs mostly feature older games, which
limits us to the ones provided by it. Hence comes the need for image processing
tools to extract data, though this may not necessarily be done by us, as will
be shown later.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Once we have discussed
about how data can be collected, we can introduce the next step, agent
building. Due to videogames, many different methods have arisen, and with the
increasing difficulty of the games beaten has also come an increase in agent intricacy,
leading to the drop of simpler techniques in favour of reinforcement learning,
which ended up performing much better in highly complex environments.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Due to the
increasingly more difficult games being beaten, has also come a need for more
intricate agents, leading to the drop of simpler techniques in favour of
reinforcement learning (many times paired with those old techniques in order to
provide the agent with basic behavioural guidance). This has ended up providing
much better results than previously achieved in highly complex environments and
discovering new strategies in the own game. Even exploits in the system have
sometimes been found, like in the case of an OpenAi project, where in a hide
and seek game, the agents managed to abuse the physics engine in various ways (
<a href="https://openai.com/blog/emergent-tool-use/">https://openai.com/blog/emergent-tool-use/</a>
).</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1><a name="_Toc73975400">1.3 Objectives</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The overall
goal of the project and how it can be achieved has already been discussed but
what will be called a success has not yet been defined.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Building an
AI capable of playing Tetris has already been done many times before with great
success, though the challenge trying to be taken has a few major and minor
hindrances.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>First of all,
as a minor inconvenience, the Tetris version we are building our AI on features
de SRS (Standard Rotation System) *, which is a modern rotation system with
some unconventional situational rotations. No implementation that can be used has
been found so an entire game replicating Tetris 99 must be built from scratch
to train our model.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Secondly, there
is not a standardized way to access the console’s controller port from a PC, so
a reliable workaround must be built and adapted. This is probably the biggest
setback.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Lastly, and
as a result of having to intercommunicate both devices, some extra delay, that
we hope will not heavily interfere, will occur when bringing everything
together.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Taking this
into account, we expect our agent to work swiftly and, if we manage to pass the
neural net’s output accurately to the console, be able to perform well when
under low gravity settings.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975401"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>2. Tetris 99 and system build</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Tetris is a
long running game series that has been going on since 1984, when Alexey
Pajitnov invented it. Ever since it was created, many iterations of the game have
been made, with each one of those somewhat altering the rules or adding new
mechanics to spice things up. As previously mentioned, the project is being
made under the Tetris 99 version, which implements the SRS.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1><a name="_Toc73975402">2.1 Game basics</a></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>As many
people already know, Tetris is a puzzle game consisting in trying to stack
pieces up pieces and clear lines on a 10x20 grid. Whenever a line is filled to
its maximum capacity it gets cleared and the blocks above it drop as many lines
as were cleared. Whenever a piece is locked in place in an altitude higher than
the game grid plus one you lose. A grid could look like this:</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=133 height=243 id="Picture 1"
src="memoriaTetrisTFG_files/image001.jpg"
alt="Tetris - Biquipedia, a enciclopedia libre"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>There is a
total of 7 different pieces, each one of those having an associated colour that
is usually maintained through all Tetris versions. Their names are I, J, L O,
S, T and Z and they look as follows:</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=171 height=233 id="Picture 3"
src="memoriaTetrisTFG_files/image002.jpg" alt="SRS | Tetris Wiki | Fandom"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>As we can see
in the image above, each piece has four different orientations which can be
accessed sequentially back and forth in the order shown, the small circle
indicating the axis the piece rotates in.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The I and O
pieces are a special case given that they do not use an actual block as their
anchor point to rotate, making the first one shift one block up or down
depending on the current position and the second one not rotate at all.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Now that we
know their shapes, we see that the maximum number of lines that can be cleared
at once is four. This is crucial because the score we obtain does not increase
linearly, netting us higher scores the more lines we clear in one go.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The actual
formula which dictates how many points we get is:</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='background:#F8F9FA;border-collapse:collapse;border:none'>
 <tr style='height:29.4pt'>
  <td style='border:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt;
  height:29.4pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>Single</span></p>
  </td>
  <td style='border:solid #A2A9B1 1.0pt;border-left:none;padding:2.4pt 4.8pt 2.4pt 4.8pt;
  height:29.4pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>100 ×
  level difficulty</span></p>
  </td>
 </tr>
 <tr>
  <td style='border:solid #A2A9B1 1.0pt;border-top:none;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>Double</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid #A2A9B1 1.0pt;
  border-right:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>300 ×
  level difficulty</span></p>
  </td>
 </tr>
 <tr>
  <td style='border:solid #A2A9B1 1.0pt;border-top:none;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>Triple</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid #A2A9B1 1.0pt;
  border-right:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>500 ×
  level difficulty</span></p>
  </td>
 </tr>
 <tr style='height:32.3pt'>
  <td style='border:solid #A2A9B1 1.0pt;border-top:none;padding:2.4pt 4.8pt 2.4pt 4.8pt;
  height:32.3pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>Tetris
  (Quadruple)</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid #A2A9B1 1.0pt;
  border-right:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt;height:32.3pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>800 ×
  level difficulty</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>More ways of
obtaining points are soft drops (moving the piece down one cell), hard drops
(letting the piece fall to the bottom) and combos (chaining line clears with
different pieces):</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='background:#F8F9FA;border-collapse:collapse;border:none'>
 <tr>
  <td style='border:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>Combo</span></p>
  </td>
  <td style='border:solid #A2A9B1 1.0pt;border-left:none;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>50 ×
  combo count × level</span></p>
  </td>
 </tr>
 <tr>
  <td style='border:solid #A2A9B1 1.0pt;border-top:none;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='color:black'><a
  href="https://tetris.wiki/Drop#Soft_drop" title=Drop><span style='font-size:
  10.5pt;color:black;text-decoration:none'>Soft drop</span></a></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid #A2A9B1 1.0pt;
  border-right:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>1 per
  cell</span></p>
  </td>
 </tr>
 <tr>
  <td style='border:solid #A2A9B1 1.0pt;border-top:none;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal><span style='color:black'><a
  href="https://tetris.wiki/Drop#Hard_drop"><span style='font-size:10.5pt;
  color:black;text-decoration:none'>Hard drop</span></a></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid #A2A9B1 1.0pt;
  border-right:solid #A2A9B1 1.0pt;padding:2.4pt 4.8pt 2.4pt 4.8pt'>
  <p class=MsoNormal style='margin-top:12.0pt;margin-right:0cm;margin-bottom:
  12.0pt;margin-left:0cm'><span style='font-size:10.5pt;color:#202122'>2 per
  cell</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Finally,
there is T-spins, which is a mechanic that will be spoken about at the end of
this block, once all the information surrounding the SRS has been laid out.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The scoring
system just described works on single player game modes, but in Tetris 99, the
main game mode actually involves 99 players concurrently battling against each
other. Here line clears serve another purpose, sending “garbage lines” to the
opponents. More on this system in the following section.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1><a name="_Toc73975403">2.2 UI and specifics</a></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>An actual
game of Tetris 99 will look like this:</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=329 height=185 id="Picture 8"
src="memoriaTetrisTFG_files/image003.png"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>There are
many things that need to be analyzed to fully understand all the game aspects
of this game version.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The first
thing that should be mentioned is that we can see the upcoming 6 pieces that
will have to be placed on the board (highlighted by the yellow square). Those
are chosen from a bag containing all seven pieces, therefore making the game
much more predictable as luck will not be impacting the game as much as with a
fully random selector.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Then, there
is the piece storage block (encapsulated by the red square), which allows us to
save the current piece and draw the next one or, if there already is a stored
one, to swap it out.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Last and more
importantly, the background shows many more smaller Tetris boards, which belong
to other players who are competing against you. In this mode you cannot see
your score, and your performance is based on surviving the longest. When
clearing lines, you now send garbage lines (grey blocks) to whoever of those
players you are targeting:</p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Clear two lines: Send one line of garbage</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Clear three lines: Send two lines of garbage</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Clear four lines: Send four lines of garbage</p>

<p class=MsoListParagraphCxSpLast style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Clear the full board: +4 lines of garbage</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Whenever you
kill a player, a part of a badge is awarded to you. Each badge is increasingly
more difficult to get, and you can only get up to four in total:</p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Two knockouts: 25% garbage bonus</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Six knockouts:   50% garbage bonus</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>14 knockouts:    75% garbage bonus</p>

<p class=MsoListParagraphCxSpLast style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>30 knockouts:    100% garbage bonus</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>It may seem
quite difficult to complete all badges, but the method is eased by being able
to steal the badges from a player you have defeated.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>You can
choose between five attacking modes to target different opponents:</p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>K.O.s: targets whoever is closer to losing the game.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Randoms.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Badges: targets whoever has more badges.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Attackers: targets whoever is attacking you.</p>

<p class=MsoListParagraphCxSpLast style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Choice: manually select a specific player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>If you are
targeted by multiple opponents, a boost to attack power is received:</p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2 Opponents:        +1 Bonus lines sent</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3 Opponents:        +3 Bonus lines sent</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>4 Opponents:        +5 Bonus lines sent</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>5 Opponents:        +7 Bonus lines sent</p>

<p class=MsoListParagraphCxSpLast style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>6+ Opponents:      +9 Bonus lines sent</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>This boost is
applied before the badge attack boost.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>It should
also be noted that when receiving garbage lines, those will first be shown in
the column right under your piece storage, and only be added to your board
after some time. The time is indicated by 3 colour stages, being grey, yellow, and
red, from best to worst. Garbage lines can also be cleared before they are
added to your board by simply clearing lines.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1><a name="_Toc73975404">2.2 SRS (Standard rotation system)</a></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Now we can
focus on the most intricate part of the game, the rotation system. The basics
of this system have already been mentioned, however there is a much deeper
pattern to it, which allows us to rotate pieces into places we would not
normally be able to. These situations occur when a rotation that is not
possible because a collision is detected, and the system tries to move the
piece into four different offsets sequentially, sticking to whichever one works
first. There are mainly two kinds of offsets, the ones that straight up ignore
some collisions and allow you to rotate passing through blocks, and the ones
that move you to another location. When an offset displaces you, it is known in
game terms as a “kick”, and it should be noted that kicks can be performed
against walls and pieces equally, propelling you in on or even two directions
at the same time, even upwards. Because of the existence of upward kicks, a
system limiting the number that can be performed had to be implemented to avoid
infinite stalling.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>As there is a
very large variety of rotations and kicks that can be performed, only a few
examples that represent most cases will be shown:</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u>No kick</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=124 height=102 id="Picture 13"
src="memoriaTetrisTFG_files/image004.png"> <img border=0 width=118 height=96
id="Picture 14" src="memoriaTetrisTFG_files/image005.png"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Piece only
phases through blocks.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u>Right kick</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=139 height=102 id="Picture 4"
src="memoriaTetrisTFG_files/image006.png"> <img border=0 width=144 height=105
id="Picture 5" src="memoriaTetrisTFG_files/image007.png"> <img border=0
width=130 height=94 id="Picture 6" src="memoriaTetrisTFG_files/image008.png"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The piece is
pushed to the right to rotate.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal><u>Up right kick</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=127 height=92 id="Picture 9"
src="memoriaTetrisTFG_files/image009.png"><img border=0 width=129 height=94
id="Picture 7" src="memoriaTetrisTFG_files/image010.png"> <img border=0
width=139 height=101 id="Picture 10" src="memoriaTetrisTFG_files/image011.png"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Piece gets
pushed up and right.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<u><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span></u>

<p class=MsoNormal><u><span style='text-decoration:none'>&nbsp;</span></u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u>Down kick
and phase through</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=139 height=126 id="Picture 11"
src="memoriaTetrisTFG_files/image012.png"> <img border=0 width=133 height=121
id="Picture 12" src="memoriaTetrisTFG_files/image013.png"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Pieces moves
down and phases through red block.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Now that we
have seen some examples, we can talk about T-spins. As its own name implies
T-spins are performed using the T piece, and they happen whenever we manage to
offset the piece into clearing 1, 2 or three lines, giving us 2, 4 and 6
garbage lines/800 × level, 1200 × level, 1600 × level respectively.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u>T-spin
single</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=396 height=49 id="Picture 1027"
src="memoriaTetrisTFG_files/image014.jpg"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u><span
 style='text-decoration:none'>&nbsp;</span></u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u>T-spin
double</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=144 height=90 id="Picture 1024"
src="memoriaTetrisTFG_files/image015.jpg"> <img border=0 width=144 height=92
id="Picture 1025" src="memoriaTetrisTFG_files/image016.jpg"> <img border=0
width=144 height=92 id="Picture 1026" src="memoriaTetrisTFG_files/image017.jpg"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u><span
 style='text-decoration:none'>&nbsp;</span></u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><u>T-spin
triple</u></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=396 height=93 id="Picture 1028"
src="memoriaTetrisTFG_files/image018.jpg"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>https://harddrop.com/</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1><a name="_Toc73975405">2.3 System</a></p>

<p class=Style1>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>In order to
reach our goal, we have to tackle the problems one by one. Thus, the means by
which the results in the project have been obtained consists of dividing it
into four different modules:</p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Switch-PC interface: The way in which the pc is able to
communicate with the console.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Information capture: How the console’s information is sent to the
pc and then processed for use by the neural net.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify'>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Machine learning: How the AI was able to learn. Includes the
training environment explanation, the heuristic used and how it was chosen.</p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-top:0cm;margin-right:0cm;
margin-bottom:6.0pt;margin-left:53.25pt;text-align:justify;text-indent:-18.0pt'><span
style='font-family:"Arial",sans-serif'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Decision making: Defines how the information extracted by the
information capture module is treated right before it is finally ready to be
sent to the net. It also explains how the output is adapted and transferred to
the console correctly.</p>

<p class=MsoListParagraphCxSpLast><span style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The
aforementioned modules will be further explained later, in their corresponding
section in the document.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975406"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>3. Switch-PC interface</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   Aquí hay
que explicar el emulador del mando hecho con Arduino, recibe comandos del
ordenador y se los pasa a la Switch</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   Aunque no
lo hayas hecho se puede describir su funcionamiento.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   </p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975407"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>4. Information capture</p>

<p class=Style1>&nbsp;</p>

<p class=Style1>4.1 Detection</p>

<p class=Style1>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>If we want to
play on the Switch, a system that allows us to decrypt what is on screen, to
feed it to the neural net is needed. To achieve this, we used a normal capture
card, so that we can process the input on the pc using OpenCV.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>As previously
mentioned, a game of Tetris99 looks like the following image:</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=332 height=187 id="Picture 1029"
src="memoriaTetrisTFG_files/image019.png"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><span
style='font-size:8.0pt'>Tetris game distribution</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Given that
the only thing which is going to give us the information we need are the
pieces, a method to detect a whether there is one and which type it is had to
be devised. At first it was thought that the type could be guessed by the piece’s
own shape but, given rotations and having access to the colour channel, a detection
by the later method was much faster. Thus, came the method to detect pieces,
which worked by calculating the mean colour of each shape (only a block was
needed) in a 5x5 matrix from its center point, including empty blocks and grey
pieces. Still, as seen in the image, when a piece is placed, it turns a darker
shade of its former colour, making us have to factor this in. Thanks to this
minor inconvenience, we will later be able to distinguish the main piece from
an already placed one if we need to do so. Finally, a small leeway to the mean
colour of each piece had to be added when checking for matches, due to other
elements in the game board influencing the colour of the own piece with shines
or shades.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The
information we get is also presented back to the user in real time by drawing
the conclusions on top of the processed frame. This helps us understand what is
being detected and therefore being fed to the neural net.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style2>4.1.1 Game grid</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The first
element we try to detect is the game grid. It can be done thanks to having
manually found where the cells center pixel is, and how wide and tall each cell
is. By applying a for loop, we can then iterate through each cell and store the
information in two arrays with the size of the game grid (10x20). The first
array contains 0s for empty cells, 1s for blocks and 2s for the main piece
(game_matrix), while the second one contains information related to the colour,
including a “no match” variable (info_matrix). On each iteration, game_matrix
block will be updated only if a match was found, else it will assume the
board’s state has not changed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style2>4.1.2 Out of the grid</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>The next
element we detect is a line upwards out of the main game matrix (row 21). This
must be done due to the main piece spawn position going up when it cannot be
placed at a certain height, the maximum being 21. This was done separately due
to the background colour not being black and because only the main piece is
displayed at that height, with placed blocks being hidden by the borders.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=248 height=140 id="Picture 1030"
src="memoriaTetrisTFG_files/image020.jpg"
alt="Tetris 99 Beginner&amp;#39;s Guide | Tips and Tricks"> </p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><span
style='font-size:8.0pt'>Main piece can be seen</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><img
border=0 width=255 height=144 id="Picture 1031"
src="memoriaTetrisTFG_files/image021.jpg"
alt="Tetris 99 Review (Switch eShop) – Be In Rose"></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><span
style='font-size:8.0pt'>Top placed blocks are invisible</span></p>

<p class=Style2>&nbsp;</p>

<p class=Style2>4.1.3 Check stored piece</p>

<p class=MsoNormal style='text-align:justify'>To detect which piece (or if
none) is in storage, a system that casts two rows of three detection points was
build. Each one of those points corresponds to a possible place of a block and,
in case it is filled, it updates two matrices with the same system that was
built for the game grid detection.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=Style2>4.1.4 Check upcoming pieces</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>In order to
know what is coming up next, we reused the system to detect stored pieces, this
time iterating through a for loop once for each of the upcoming six pieces. Each
of the matrices detected is then stored in an array in the same order they are
detected (top to bottom).</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Even though
this system was built, it is not currently being used due to it apparently not
increasing the neural net’s performance in any way.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<p class=Style1>4.2 Information adaptation to the neural net</p>

<p class=MsoNormal style='text-align:justify'>Once all the information needed
has been collected, a way of adapting it so that the neural net understands it
had to be made. To do so, we had to convert the data into a Board object of our
own Tetris game, with the same configuration detected.</p>

<p class=MsoNormal style='text-align:justify'>As our neural net works by
finding the best combination of consecutive rotations and horizontal movement,
and then dropping the piece, we only need to ask for the neural net’s response
once (when the piece just spawned). This way we only try to detect new
information when the last sequence of movements is completed and when a new
piece is detected at the top three rows of the grid, which are the only rows a
piece can spawn in.</p>

<p class=MsoNormal style='text-align:justify'>When a new main piece is
detected, which as mentioned before can be done thanks to it being able to be
told apart from the rest because of being slightly brighter, we construct a
Piece object with its type and position. The type can easily be guessed just by
checking the first block’s colour but the position is trickier. As all pieces
always spawn in the same exact rotation, given a colour we can infer where the
center block of the piece, the one giving it its true location, is:</p>

<p class=MsoNormal style='text-align:justify'><img border=0 width=188
height=238 id="Picture 16" src="memoriaTetrisTFG_files/image022.jpg"></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The red arrow shows the first
detected block, and the green one is where its true location is (x: +1, y: -1).</p>

<p class=MsoNormal style='text-align:justify'>We can now proceed with the
creation of the game grid that will be added to the Board object. It is quite
simple to do so given that we have a 10x20 array stored with information
regarding each cell. We now only have to filter out the main piece, add four
empty rows at the top and reverse it to match the object’s model. The actual
colour of the placed blocks does not matter, as it is merely an aesthetic
element.</p>

<p class=MsoNormal style='text-align:justify'>Finally, we check if there is a
stored piece. If positive, we must then check its colour to know if it is an
option for it to be placed or not. That information is then passed on to the Board.</p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975408"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>5. Deep learning module</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   Aquí
hablar del juego Tetris implementado, y que la red aprende sobre ello</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   </p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975409"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>6. <a name="_Hlk72327719">Decision making</a></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   Explicar
que este módulo recoge la información del módulo de captura de información, la
procesa con el sistema generado en el </p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'> módulo de
aprendizaje, encola las órdendes, y las manda emulador del mando</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>                        </p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975410"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>7. Results</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>   Pequeña
estadística de partidas jugadas y resultados obtenidos</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>&nbsp;</p>

<span style='font-size:12.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name="_Toc73975411"><span style='font-size:16.0pt;
font-family:"Arial",sans-serif;color:#2F5496'>&nbsp;</span></a></p>

<p class=Titulo>8. Conclusions</p>

</div>

</body>

</html>
